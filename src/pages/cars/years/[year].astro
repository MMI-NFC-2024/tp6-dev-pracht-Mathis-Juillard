---
import Layout from "../../../layouts/Layout.astro";
import * as Plot from "@observablehq/plot";
import cars from "../../../assets/cars.json";
import PlotFigure from "../../../components/PlotFigure.astro";

export const prerender = false; // route dynamique

const { year } = Astro.params;
const rows = cars.filter(c => String(c.year) === String(year));

const options = {
  width: 960,
  height: 520,
  grid: true,
  marks: [
    Plot.dot(rows, {
      x: "weight (lb)",
      y: "power (hp)",
      r: 4,
      fill: "steelblue",
      fillOpacity: 0.75,
      tip: true
    })
  ],
  x: { label: "Poids (lb)" },
  y: { label: "Puissance (hp)" },
  marginLeft: 56,
  marginBottom: 48
};
---

<Layout title={`Voitures — ${year}`}>
  <a href="/cars/years" style="display:inline-block;margin:.5rem 0 1rem">← Retour</a>
  <h1>Voitures de l’année {year}</h1>
  <p>{rows.length} voiture(s) trouvée(s).</p>

  <PlotFigure {options} />
</Layout>
